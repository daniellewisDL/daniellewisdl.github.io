<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Genuary 2023</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>body { font-family: monospace;}</style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
  </head>

  <body style="background-color: rgb(255, 255, 255);">
    <header>
      <h1>Genuary 2023 | Day 17 | A grid inside a grid inside a grid</h1>
    </header>
    <div id="myCanvas"></div>
    <br><hr><br>

    
    <script>
      
      var s = function( p ) {

          let width = 1200
          let height = 1200
          let chars = []
          let textSizeStart = 50
          let dx = textSizeStart /10
          let level = 0
          let maxLevel = 6
          let boxMargin = p.random(-10,20)
          let boxSize = p.random(50,200)

          function initialiseChars() {
              for (let setupChars = 8; setupChars <= 198; setupChars++) {
                chars.push(String.fromCharCode(0x2F00+setupChars))
              }
              chars.splice(5,1)
              chars.splice(30,1)
              // console.log(chars)
          }

          p.setup = function() {
            p.createCanvas(width,height)
            p.frameRate(10)
            p.textSize(textSizeStart)
            p.background(255, 254, 233)
            initialiseChars()
          }

          p.draw = function() {
            // p.noLoop()          
            
            p.background(255, 254, 233,80)
            // drawPaper()
            p.stroke(50,50)
            p.noFill()

            for (let i = 0; i < width/boxSize; i++) {
              for (let j = 0; j < height/boxSize; j++) {
                let x1 = i*boxSize+boxMargin
                let y1 = j*boxSize+boxMargin
                let boxWidth = boxSize-2*boxMargin
                let boxHeight = boxWidth
                let x2 = x1 + boxWidth
                let y2 = y1 + boxHeight

                
                p.stroke("grey")
                p.strokeWeight(1)
                setLineDash([]) //another dashed line pattern

                p.rect(x1,y1,boxWidth,boxHeight)
                p.strokeWeight(0.25)
                // Draw vert/horiz/diag/diag dotted red/blue lines in each square
                p.stroke(p.random(["green","red","blue"]))

                setLineDash([5, 5]) //another dashed line pattern
                p.line(x1,y1,x2,y2)
                p.line(x1,y2,x2,y1)
                p.line(x1+boxWidth/2,y1,x1+boxWidth/2,y2)
                p.line(x1,y1+boxHeight/2,x2,y1+boxHeight/2)

                splitBox(i*boxSize+boxMargin,j*boxSize+boxMargin,boxSize-2*boxMargin,boxSize-2*boxMargin,0)

              }
            }

          }


            function setLineDash(list) {
              p.drawingContext.setLineDash(list);
            }

          function drawPaper() {
              p.fill(90)
              p.stroke(50,18)
              for(let threads = 0; threads < 40000; threads++) {
                let x1 = Math.random() * width;
                let y1 = Math.random() * height;
                let theta = Math.random() * 2 * Math.PI;
                let segmentLength = Math.random() * 5 + 2;
                let x2 = Math.cos(theta) * segmentLength + x1;
                let y2 = Math.sin(theta) * segmentLength + y1;
                p.line(x1, y1, x2, y2)
              }
          }


          function splitBox(x,y,boxSizeX,boxSizeY,level) {
            
            // p.rect(x,y,boxSizeX,boxSizeY)
            let splitList = ["full", "left-right", "top-bottom"]

            if (level != maxLevel) {
              if (level == 0 && Math.random()<0.9) {splitList = ["left-right", "top-bottom"]}
              let splitter = p.random(splitList)
              if (splitter == "left-right") {
                  splitBox(x,y,boxSizeX/2,boxSizeY,level+1)
                  splitBox(x+boxSizeX/2,y,boxSizeX/2,boxSizeY,level+1)
              } else if (splitter == "top-bottom") {
                  splitBox(x,y,boxSizeX,boxSizeY/2,level+1)
                  splitBox(x,y+boxSizeY/2,boxSizeX,boxSizeY/2,level+1)
              } else {
                  p.rect(x,y,boxSizeX,boxSizeY)
                  // drawChar(x,y,boxSizeX,boxSizeY)
              }                
            } else {
                  p.rect(x,y,boxSizeX,boxSizeY)
                  // drawChar(x,y,boxSizeX,boxSizeY)
            } 
          }


          


          function drawChar(x,y,xSize,ySize) {
            dy = 5

            p.push()
            
            p.noStroke()
            p.fill(100)

            p.textSize(textSizeStart)
            p.textAlign(p.CENTER, p.CENTER)
            p.translate(x+xSize/2,y+ySize/2)
            p.scale(xSize/(textSizeStart*1.2),ySize/(textSizeStart*1.2))
            p.text(p.random(chars),0,dy)
            
            

            p.pop()
          }


      }
      
      let myp5 = new p5(s, "myCanvas")

    </script>
  </body>
</html>
