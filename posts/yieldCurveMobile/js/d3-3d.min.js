!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).d3={})}(this,function(t){"use strict";function g(t,e){return{x:e.origin.x+e.scale*t.x,y:e.origin.y+e.scale*t.y}}function h(t){return t.x}function j(t){return t.y}function s(t){return t.z}function l(t,e){t=t.centroid.z,e=e.centroid.z;return t<e?-1:e<t?1:e<=t?0:NaN}function e(e,t){let r=0,n=0,o=0,c={x:0,y:0},i={x:0,y:0,z:0},u=1,f=h,d=j,a=s,y=0;function x(t){return e(t,{scale:u,origin:c,project:g,row:y},{x:f,y:d,z:a},{x:r,y:n,z:o,rotateCenter:i})}return x.origin=function(t){return arguments.length?(c=t,x):c},x.scale=function(t){return arguments.length?(u=t,x):u},x.rotateX=function(t){return arguments.length?(r=t,x):r},x.rotateY=function(t){return arguments.length?(n=t,x):n},x.rotateZ=function(t){return arguments.length?(o=t,x):o},x.rotationCenter=function(t){return arguments.length?(i=t,x):i},x.x=function(t){return arguments.length?(f="function"==typeof t?t:+t,x):f},x.y=function(t){return arguments.length?(d="function"==typeof t?t:+t,x):d},x.z=function(t){return arguments.length?(a="function"==typeof t?t:+t,x):a},x.rows=function(t){return arguments.length?(y="function"==typeof t?t:+t,x):y},x.draw=t,x.sort=l,x}function v(e){var r=[...e,e[0]];let n=0;for(let t=0;t<e.length;t++){var o=t+1,c=r[t].rotated,o=r[o].rotated;n+=(o.x-c.x)*(o.y+c.y)}return 0<n}function $(e){let r=0,n=0,o=0;var c=e.length;for(let t=c-1;0<=t;t--){var i=e[t].rotated;r+=i.x,n+=i.y,o+=i.z}return{x:r/c,y:n/c,z:o/c}}function a(t,e){var r,n=e.rotateCenter,o=(t.x-=n.x,t.y-=n.y,t.z-=n.z,t=t,r=e.z,o=Math.sin(r),r=Math.cos(r),{x:t.x*r-t.y*o,y:t.x*o+t.y*r,z:t.z}),t=(r=o,t=e.y,o=Math.sin(t),t=Math.cos(t),{x:r.z*o+r.x*t,y:r.y,z:r.z*t-r.x*o}),e=(r=t,o=e.x,t=Math.sin(o),o=Math.cos(o),{x:r.x,y:r.y*o-r.z*t,z:r.y*t+r.z*o});return e.x+=n.x,e.y+=n.y,e.z+=n.z,e}function w(e,r,n,o){for(let t=e.length-1;0<=t;t--){var c=e[t];c.rotated=a({x:n.x(c),y:n.y(c),z:n.z(c)},o),c.centroid=c.rotated,c.projected=r.project(c.rotated,r)}return e}function L(t){return`M${t[0].projected.x},${t[0].projected.y}L${t[1].projected.x},${t[1].projected.y}L${t[2].projected.x},${t[2].projected.y}L${t[3].projected.x},${t[3].projected.y}Z`}function N(e,r,n,o){for(let t=e.length-1;0<=t;t--){var c=e[t],i=w([c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7]],r,n,o),u=i[0],f=i[1],d=i[2],a=i[3],y=i[4],x=i[5],l=i[6],i=i[7],p=[u,f,d,a],z=[i,l,x,y],g=[y,x,f,u],h=[a,d,l,i],y=[y,u,a,i],u=[f,x,l,d];p.centroid=$(p),z.centroid=$(z),g.centroid=$(g),h.centroid=$(h),y.centroid=$(y),u.centroid=$(u),p.ccw=v(p),z.ccw=v(z),g.ccw=v(g),h.ccw=v(h),y.ccw=v(y),u.ccw=v(u),p.face="front",z.face="back",g.face="left",h.face="right",y.face="top",u.face="bottom",c.faces=[p,z,g,h,y,u],c.centroid={x:(g.centroid.x+h.centroid.x)/2,y:(y.centroid.y+u.centroid.y)/2,z:(p.centroid.z+z.centroid.z)/2}}return e}function I(t,e,r,n){var o=w(t,e,r,n),c=[],i=e.row;let u=0;for(var f=o.length/i-1;0<f;f--)for(var d=i-1;0<d;d--){var a=d+f*i,y=a-1,x=y-i+1,a=[o[a],o[x],o[x-1],o[y]];a.plane="plane-"+u++,a.ccw=v(a),a.centroid=$(a),c.push(a)}return c}function E(t){var e=t[t.length-1];let r=`M${e.projected.x},`+e.projected.y;for(var n=t.length-2;0<=n;n--){var o=t[n].projected;r+=`L${o.x},`+o.y}return r}function D(e,r,n,o){for(let t=e.length-1;0<=t;t--){var c=e[t],i=c.length/2,u=parseInt(i);for(let t=c.length-1;0<=t;t--){var f=c[t];f.rotated=a({x:n.x(f),y:n.y(f),z:n.z(f)},o),f.projected=r.project(f.rotated,r)}c.centroid=u===i?$([c[i-1],c[i]]):{x:c[u].rotated.x,y:c[u].rotated.y,z:c[u].rotated.z}}return e}function M(t,e,r,n){for(var o=t.length-1;0<=o;o--){var c=t[o],i=c[0],u=c[1];i.rotated=a({x:r.x(i),y:r.y(i),z:r.z(i)},n),u.rotated=a({x:r.x(u),y:r.y(u),z:r.z(u)},n),i.projected=e.project(i.rotated,e),u.projected=e.project(u.rotated,e),c.centroid=$(c)}return t}function C(e,r,n,o){for(let t=e.length-1;0<=t;t--){var c=e[t],i=c[0],u=c[1],f=c[2],d=c[3];i.rotated=a({x:n.x(i),y:n.y(i),z:n.z(i)},o),u.rotated=a({x:n.x(u),y:n.y(u),z:n.z(u)},o),f.rotated=a({x:n.x(f),y:n.y(f),z:n.z(f)},o),d.rotated=a({x:n.x(d),y:n.y(d),z:n.z(d)},o),i.projected=r.project(i.rotated,r),u.projected=r.project(u.rotated,r),f.projected=r.project(f.rotated,r),d.projected=r.project(d.rotated,r),c.ccw=v(c),c.centroid=$(c)}return e}const T=t=>`M${t[0].projected.x},${t[0].projected.y}L${t[1].projected.x},${t[1].projected.y}L${t[2].projected.x},${t[2].projected.y}Z`;function P(e,r,n,o){for(let t=e.length-1;0<=t;t--){var c=e[t],i=c[0],u=c[1],f=c[2];i.rotated=a({x:n.x(i),y:n.y(i),z:n.z(i)},o),u.rotated=a({x:n.x(u),y:n.y(u),z:n.z(u)},o),f.rotated=a({x:n.x(f),y:n.y(f),z:n.z(f)},o),i.projected=r.project(i.rotated,r),u.projected=r.project(u.rotated,r),f.projected=r.project(f.rotated,r),c.ccw=v(c),c.centroid=$(c)}return e}function r(e){var t=e[e.length-1];let r=`M${t.projected.x},`+t.projected.y;for(let t=e.length-2;0<=t;t--){var n=e[t].projected;r+=`L${n.x},`+n.y}return r+="Z"}function n(t,e,r,n){for(var o=t.length-1;0<=o;o--){for(var c=t[o],i=c.length-1;0<=i;i--){var u=c[i];u.rotated=a({x:r.x(u),y:r.y(u),z:r.z(u)},n),u.projected=e.project(u.rotated,e)}c.ccw=v(c),c.centroid=$(c)}return t}t._3d=function(){var e={x:0,y:0},r=1,n=g,o=0,c=0,i=0,u={x:0,y:0,z:0},f=h,d=j,a=s,y=void 0,x="POINT",l={CUBE:N,GRID:I,LINE:M,LINE_STRIP:D,PLANE:C,POINT:w,SURFACE:I,TRIANGLE:P},p={CUBE:L,GRID:L,LINE_STRIP:E,PLANE:L,SURFACE:L,TRIANGLE:T};function z(t){return l[x](t,{scale:r,origin:e,project:n,row:y},{x:f,y:d,z:a},{x:o,y:c,z:i,rotateCenter:u})}return z.origin=function(t){return arguments.length?(e=t,z):e},z.scale=function(t){return arguments.length?(r=t,z):r},z.rotateX=function(t){return arguments.length?(o=t,z):o},z.rotateY=function(t){return arguments.length?(c=t,z):c},z.rotateZ=function(t){return arguments.length?(i=t,z):i},z.shape=function(t,e){return arguments.length?(x=t,y=e,z):x},z.rotateCenter=function(t){return arguments.length?(u=t,z):u},z.x=function(t){return arguments.length?(f="function"==typeof t?t:+t,z):f},z.y=function(t){return arguments.length?(d="function"==typeof t?t:+t,z):d},z.z=function(t){return arguments.length?(a="function"==typeof t?t:+t,z):a},z.sort=function(t,e){t=t.centroid.z,e=e.centroid.z;return t<e?-1:e<t?1:e<=t?0:NaN},z.draw=function(t){if("POINT"!==x&&"LINE"!==x)return p[x](t)},z},t.cubes3D=function(){return e(N,L)},t.gridPlanes3D=function(){return e(I,L)},t.lineStrips3D=function(){return e(D,E)},t.lines3D=function(){return e(M,void 0)},t.planes3D=function(){return e(C,L)},t.points3D=function(){return e(w,void 0)},t.polygons3D=function(){return e(n,r)},t.triangles3D=function(){return e(P,T)}});